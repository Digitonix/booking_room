<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Working Space Jakarta 2</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Menghubungkan ke Tailwind CSS CDN dan font 'Inter' dari Google Fonts -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Mengganti placeholder dengan Font Awesome CDN yang valid untuk memastikan ikon dimuat dengan benar -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="icon" type="image/png" href="https://img.icons8.com/?size=100&id=bY5t0noHcfXn&format=png&color=000000">
    <style>
        /* Menggunakan font Inter dari Google Fonts */
        body {
            font-family: 'Inter', sans-serif;
            /* Menambahkan gambar latar belakang */
            background-image: url("{{ url_for('static', filename='uploads/background.jpg') }}");
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
        }
        /* Rotasi ikon dropdown */
        .dropdown-icon-rotated {
            transform: rotate(180deg);
        }
    </style>
</head>
<body class="text-gray-800">

<!-- Kontainer utama dashboard dengan desain modern -->
<div class="container mx-auto px-4 py-8 md:py-12">
    <!-- Efek transparansi pada kontainer utama -->
    <div class="bg-white/80 backdrop-blur-md rounded-3xl shadow-2xl p-6 md:p-10 lg:p-12 relative">
        <div class="flex flex-col md:flex-row items-start md:items-center justify-between mb-8 md:mb-12">
            <h2 class="text-indigo-600 font-bold text-3xl md:text-4xl mb-4 md:mb-0">
                <i class="fas fa-laptop-house mr-3"></i>Working Space Jakarta 2
            </h2>
            
            {% if session['user_id'] %}
            <!-- Tombol Logout responsif, full-width di mobile, pojok kanan atas di desktop -->
            <div class="w-full md:w-auto mt-4 md:mt-0">
                <button id="logout-button"
                    class="bg-red-500 text-white font-semibold py-2 px-4 rounded-full shadow-md hover:bg-red-600 transition-colors duration-300 w-full md:w-auto">
                    <i class="fas fa-sign-out-alt mr-2"></i>Logout
                </button>
            </div>
            {% endif %}
        </div>

        <!-- Pesan sambutan yang lebih modern dan ramah -->
        <div class="mb-8 md:mb-12">
            <h1 class="text-gray-800 font-bold text-3xl md:text-5xl mb-2">
                Hallo <span class="text-indigo-600">{{ session['username'] }}</span>,
            </h1>
            <p class="text-gray-600 text-lg md:text-2xl">
                Selamat datang di aplikasi Working Space Jakarta 2.
            </p>
        </div>

        <!-- Tombol Aksi - tata letak responsif -->
        <div class="flex flex-wrap justify-center md:justify-start gap-4 mb-10">
            {% if session['role'] == 'admin' %}
            <!-- Menu Jadwal TV Display -->
            <div class="w-full sm:w-auto">
                <a href="{{ url_for('tv_schedule') }}" class="btn-modern bg-teal-500 hover:bg-teal-600 text-white font-semibold py-3 px-6 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 w-full flex items-center justify-center">
                    <i class="fas fa-tv mr-2"></i>Jadwal TV Display
                </a>
            </div>
            {% endif %}

            <!-- Dropdown untuk pilihan konfigurasi admin -->
            {% if session['role'] == 'admin' %}
            <div class="relative inline-block text-left w-full sm:w-auto">
                <button class="bg-gray-200 text-gray-700 font-semibold py-3 px-6 w-full rounded-full flex items-center justify-between transition-all duration-300 hover:bg-gray-300 focus:outline-none" type="button" id="configDropdown" aria-expanded="false">
                    <span><i class="fas fa-cog mr-2"></i>Pilihan Konfigurasi</span>
                    <i class="fas fa-chevron-down ml-2 transition-transform duration-300 dropdown-icon"></i>
                </button>
                <!-- Efek transparansi pada menu dropdown -->
                <ul class="absolute mt-2 w-full rounded-xl shadow-lg bg-white/80 backdrop-blur-md z-10 transition-all duration-300 transform scale-95 opacity-0 invisible" aria-labelledby="configDropdown" id="configDropdownMenu">
                    <li><a class="dropdown-item block px-4 py-3 hover:bg-gray-100 rounded-t-xl transition-colors duration-200" href="{{ url_for('manage_rooms') }}"><i class="fas fa-door-open mr-2"></i>Kelola Ruangan</a></li>
                    <li><a class="dropdown-item block px-4 py-3 hover:bg-gray-100 transition-colors duration-200" href="{{ url_for('manage_users') }}"><i class="fas fa-users-cog mr-2"></i>Kelola Pengguna</a></li>
                    <li><a class="dropdown-item block px-4 py-3 hover:bg-gray-100 transition-colors duration-200" href="{{ url_for('manage_images') }}"><i class="fas fa-images mr-2"></i>Kelola Gambar TV</a></li>
                    <li><a class="dropdown-item block px-4 py-3 hover:bg-gray-100 rounded-b-xl transition-colors duration-200" href="{{ url_for('manage_bookings') }}"><i class="fas fa-calendar-times mr-2"></i>Kelola Booking</a></li>
                </ul>
            </div>
            {% endif %}
        </div>

        <!-- Tombol Aksi dalam bentuk card modern -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-10">
            <!-- Card untuk Jadwal dengan efek transparansi -->
            <div class="card-modern bg-white/80 backdrop-blur-md rounded-xl shadow-md p-6 h-full flex flex-col justify-between transition-all duration-300 hover:shadow-xl hover:scale-105">
                <div>
                    <h4 class="text-gray-800 font-bold text-xl mb-2">
                        <i class="fas fa-calendar-alt mr-3 text-sky-500"></i>Jadwal
                    </h4>
                    <p class="text-gray-500 mb-4">Lihat semua jadwal booking ruangan yang tersedia dan yang sudah terisi.</p>
                </div>
                <a href="{{ url_for('schedule_view') }}" class="w-full text-center bg-green-500 hover:bg-green-600 text-white font-semibold py-3 px-6 rounded-full transition-colors duration-300">
                    <i class="fas fa-external-link-alt mr-2"></i>Buka Jadwal Lengkap
                </a>
            </div>
            
            <!-- Card untuk Booking Ruangan dengan efek transparansi -->
            <div class="card-modern bg-white/80 backdrop-blur-md rounded-xl shadow-md p-6 h-full flex flex-col justify-between transition-all duration-300 hover:shadow-xl hover:scale-105">
                <div>
                    <h4 class="text-gray-800 font-bold text-xl mb-2">
                        <i class="fas fa-plus-circle mr-3 text-indigo-500"></i>Booking Ruangan
                    </h4>
                    <p class="text-gray-500 mb-4">Buat booking ruangan baru dengan mudah.</p>
                </div>
                <a href="{{ url_for('book') }}" class="w-full text-center bg-indigo-500 hover:bg-indigo-600 text-white font-semibold py-3 px-6 rounded-full transition-colors duration-300">
                    <i class="fas fa-external-link-alt mr-2"></i>Buat Booking
                </a>
            </div>
        </div>

        <!-- Konten ruangan dengan grid yang responsif -->
        <h3 class="text-gray-800 font-bold text-2xl md:text-3xl mb-6">
            <i class="fas fa-list mr-3"></i>Daftar Ruangan Tersedia
        </h3>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
            {% for room in rooms %}
            <!-- Card ruangan dengan tombol "Jadwal" yang telah diubah agar lebih rapi -->
            <div class="room-card bg-white/80 backdrop-blur-md rounded-2xl shadow-md hover:shadow-xl p-6 transition-transform transform hover:-translate-y-1 border-t-4 border-indigo-500">
                <div class="flex flex-col md:flex-row md:justify-between md:items-center mb-2">
                    <h3 class="text-xl font-bold text-indigo-600 mb-2 md:mb-0">
                        <i class="fas fa-door-open mr-2"></i>{{ room.name }}
                    </h3>
                    <a href="{{ url_for('tv_display', room_id=room.id) }}" class="py-2 px-4 bg-sky-500 text-white text-sm font-semibold rounded-full hover:bg-sky-600 transition-colors duration-300 shadow-md flex items-center justify-center">
                        <i class="fas fa-tv mr-2"></i>Jadwal
                    </a>
                </div>
                <p class="text-gray-700"><strong>Lantai:</strong> {{ room.lantai or 'Tidak Ditentukan' }}</p>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- Modal Logout dengan desain yang lebih modern -->
<div id="logout-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[9999] hidden">
    <!-- Efek transparansi pada konten modal -->
    <div id="logout-modal-content"
          class="bg-white/80 backdrop-blur-md rounded-3xl shadow-2xl p-8 max-w-sm w-full mx-auto text-center transform transition-all duration-300 scale-95 opacity-0">
        <div class="flex flex-col items-center justify-center mb-6">
            <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4">
                <i class="fas fa-sign-out-alt text-red-500 text-3xl"></i>
            </div>
            <h3 class="text-2xl font-bold text-gray-800 mb-2">Konfirmasi Logout</h3>
            <p class="text-gray-600 text-lg">Apakah Anda yakin ingin keluar dari akun ini?</p>
        </div>
        <div class="flex justify-center gap-4">
            <button id="cancel-logout"
                    class="bg-gray-200 text-gray-800 font-semibold py-3 px-6 rounded-full hover:bg-gray-300 transition-colors duration-300 w-full">
                Batal
            </button>
            <form method="POST" action="{{ url_for('logout') }}" class="w-full">
                <button type="submit"
                        class="bg-red-500 text-white font-semibold py-3 px-6 rounded-full hover:bg-red-600 transition-colors duration-300 w-full">
                    Ya, Logout
                </button>
            </form>
        </div>
    </div>
</div>

<!-- Script Modal & Dropdown -->
<script>
document.addEventListener('DOMContentLoaded', function () {
    // Logic untuk Modal Logout
    const logoutButton = document.getElementById('logout-button');
    const logoutModal = document.getElementById('logout-modal');
    const modalContent = document.getElementById('logout-modal-content');
    const cancelLogout = document.getElementById('cancel-logout');

    if (logoutButton && logoutModal && modalContent) {
        logoutButton.addEventListener('click', function (e) {
            e.preventDefault();
            logoutModal.classList.remove('hidden');
            setTimeout(() => {
                modalContent.classList.remove('scale-95', 'opacity-0');
                modalContent.classList.add('scale-100', 'opacity-100');
            }, 10);
        });

        function closeModal() {
            modalContent.classList.remove('scale-100', 'opacity-100');
            modalContent.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                logoutModal.classList.add('hidden');
            }, 300);
        }

        cancelLogout.addEventListener('click', closeModal);
        logoutModal.addEventListener('click', function (e) {
            if (e.target === logoutModal) {
                closeModal();
            }
        });
    }

    // Logic untuk Dropdown Konfigurasi
    const configDropdownButton = document.getElementById('configDropdown');
    const configDropdownMenu = document.getElementById('configDropdownMenu');
    const configDropdownIcon = document.querySelector('.dropdown-icon');

    if (configDropdownButton && configDropdownMenu) {
        configDropdownButton.addEventListener('click', function (e) {
            e.stopPropagation(); // Mencegah event menyebar ke body
            const isExpanded = this.getAttribute('aria-expanded') === 'true';

            if (isExpanded) {
                // Tutup dropdown
                configDropdownMenu.classList.add('scale-95', 'opacity-0', 'invisible');
                configDropdownMenu.classList.remove('scale-100', 'opacity-100', 'visible');
                configDropdownIcon.classList.remove('dropdown-icon-rotated');
                this.setAttribute('aria-expanded', 'false');
            } else {
                // Buka dropdown
                configDropdownMenu.classList.remove('scale-95', 'opacity-0', 'invisible');
                configDropdownMenu.classList.add('scale-100', 'opacity-100', 'visible');
                configDropdownIcon.classList.add('dropdown-icon-rotated');
                this.setAttribute('aria-expanded', 'true');
            }
        });

        // Menutup dropdown ketika klik di luar menu
        document.addEventListener('click', function (e) {
            if (!configDropdownMenu.contains(e.target) && !configDropdownButton.contains(e.target)) {
                configDropdownMenu.classList.add('scale-95', 'opacity-0', 'invisible');
                configDropdownMenu.classList.remove('scale-100', 'opacity-100', 'visible');
                configDropdownIcon.classList.remove('dropdown-icon-rotated');
                configDropdownButton.setAttribute('aria-expanded', 'false');
            }
        });
    }
});
</script>

</body>
</html>
