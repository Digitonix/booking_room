<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Working Space Jakarta 2</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="icon" type="image/png" href="https://img.icons8.com/?size=100&id=bY5t0noHcfXn&format=png&color=000000">
    <style>
        body {
            font-family: 'Inter', sans-serif;

            background-image: url("{{ url_for('static', filename='uploads/background.jpg') }}");
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
        }
        .dropdown-icon-rotated {
            transform: rotate(180deg);
        }

        .header-title-full-mobile {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: clip;
            font-size: 5vw;
            /* max-font-size: 1.875rem; */
            line-height: 1;
            display: inline-block;
        }
        @media (min-width: 640px) { /* sm breakpoint */
            .header-title-full-mobile {
                font-size: 1.875rem;
                white-space: normal;
                overflow: visible;
                text-overflow: clip;
            }
        }
      
        .pagination a.active {
            background-color: #4338ca; /* Indigo-700 */
            color: white;
        }
    </style>
</head>
<body class="text-gray-800">

<div class="container mx-auto px-4 py-6 sm:py-8">
    <div class="bg-white/80 backdrop-blur-md rounded-3xl shadow-2xl p-4 sm:p-6 lg:p-8 relative">

        <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 sm:mb-8">
            <h2 class="text-blue-600 font-bold text-center sm:text-left w-full sm:w-auto">
                <span class="header-title-full-mobile"><i class="fas fa-laptop-house mr-2"></i>Working Space Jakarta 2</span>
            </h2>
            
            {% if session['user_id'] %}
            <div class="hidden sm:block w-full sm:w-auto mt-3 sm:mt-0">
                <!-- Tombol Logout -->
                <button id="logout-button-desktop"
                    class="bg-red-500 text-white font-semibold py-2 px-4 rounded-full shadow-md hover:bg-red-600 transition-colors duration-300 w-full">
                    <i class="fas fa-sign-out-alt mr-2"></i>Logout
                </button>
            </div>
            {% endif %}
        </div>

        <div class="mb-6 sm:mb-10 text-center sm:text-left">
            <h1 class="text-gray-800 font-bold text-2xl sm:text-4xl mb-1">
                Hallo <span class="text-blue-600">{{ session['username'] }}</span>,
            </h1>
            <p class="text-gray-600 text-base sm:text-xl">
                Selamat datang di aplikasi Working Space Jakarta 2.
            </p>
        </div>

        <div class="flex flex-col sm:flex-row justify-center sm:justify-start gap-4 mb-8">
            {% if session['role'] == 'admin' %}
            <div class="w-full sm:w-auto">
   
                <a href="{{ url_for('tv_schedule') }}" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 w-full flex items-center justify-center text-center">
                    <i class="fas fa-tv mr-2"></i>Jadwal TV Display
                </a>
            </div>
            {% endif %}
            
      
            {% if session['user_id'] %}
            <div class="w-full sm:w-auto">
                <a href="{{ url_for('my_bookings') }}" class="bg-cyan-500 hover:bg-cyan-600 text-white font-semibold py-3 px-6 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 w-full flex items-center justify-center text-center">
                    <i class="fas fa-calendar-check mr-2"></i>Booking Saya
                </a>
            </div>
            {% endif %}

        
            {% if session['role'] == 'admin' %}
            <div class="relative w-full sm:w-auto">
                <button class="bg-amber-500 text-white font-semibold py-3 px-6 w-full rounded-full flex items-center justify-center sm:justify-between transition-all duration-300 hover:bg-amber-600 focus:outline-none" type="button" id="configDropdown" aria-expanded="false">
                    <span><i class="fas fa-cog mr-2"></i>Pilihan Konfigurasi</span>
                    <i class="fas fa-chevron-down ml-2 transition-transform duration-300 dropdown-icon hidden sm:inline-block"></i>
                </button>
                <ul class="absolute mt-2 w-full rounded-xl shadow-lg bg-white/80 backdrop-blur-md z-10 transition-all duration-300 transform scale-95 opacity-0 invisible" aria-labelledby="configDropdown" id="configDropdownMenu">
                    <li><a class="dropdown-item block px-4 py-3 hover:bg-gray-100 rounded-t-xl transition-colors duration-200" href="{{ url_for('manage_rooms') }}"><i class="fas fa-door-open mr-2"></i>Kelola Ruangan</a></li>
                    <li><a class="dropdown-item block px-4 py-3 hover:bg-gray-100 transition-colors duration-200" href="{{ url_for('manage_users') }}"><i class="fas fa-users-cog mr-2"></i>Kelola Pengguna</a></li>
                    <li><a class="dropdown-item block px-4 py-3 hover:bg-gray-100 transition-colors duration-200" href="{{ url_for('manage_images') }}"><i class="fas fa-images mr-2"></i>Kelola Gambar TV</a></li>
                    <li><a class="dropdown-item block px-4 py-3 hover:bg-gray-100 rounded-b-xl transition-colors duration-200" href="{{ url_for('manage_bookings') }}"><i class="fas fa-calendar-times mr-2"></i>Kelola Booking</a></li>
                </ul>
            </div>
            {% endif %}
            
            {% if session['user_id'] %}
            <div class="block sm:hidden w-full sm:w-auto">
              
                <button id="logout-button-mobile"
                    class="bg-red-500 text-white font-semibold py-2 px-4 rounded-full shadow-md hover:bg-red-600 transition-colors duration-300 w-full">
                    <i class="fas fa-sign-out-alt mr-2"></i>Logout
                </button>
            </div>
            {% endif %}
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <div class="card-modern bg-white/80 backdrop-blur-md rounded-xl shadow-md p-5 h-full flex flex-col justify-between transition-all duration-300 hover:shadow-xl hover:scale-105">
                <div>
                    <h4 class="text-gray-800 font-bold text-lg sm:text-xl mb-2">
                        <i class="fas fa-calendar-alt mr-3 text-emerald-500"></i>Jadwal
                    </h4>
                    <p class="text-gray-500 text-sm sm:text-base mb-4">Lihat semua jadwal booking ruangan yang tersedia dan yang sudah terisi.</p>
                </div>
                <a href="{{ url_for('schedule_view') }}" class="w-full text-center bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-full transition-colors duration-300 text-sm">
                    <i class="fas fa-external-link-alt mr-2"></i>Buka Jadwal Lengkap
                </a>
            </div>
            
            <div class="card-modern bg-white/80 backdrop-blur-md rounded-xl shadow-md p-5 h-full flex flex-col justify-between transition-all duration-300 hover:shadow-xl hover:scale-105">
                <div>
                    <h4 class="text-gray-800 font-bold text-lg sm:text-xl mb-2">
                        <i class="fas fa-plus-circle mr-3 text-blue-500"></i>Booking Ruangan
                    </h4>
                    <p class="text-gray-500 text-sm sm:text-base mb-4">Buat booking ruangan baru dengan mudah.</p>
                </div>
                <a href="{{ url_for('book') }}" class="w-full text-center bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-full transition-colors duration-300 text-sm">
                    <i class="fas fa-external-link-alt mr-2"></i>Buat Booking
                </a>
            </div>
        </div>

        <h3 class="text-gray-800 font-bold text-xl sm:text-2xl mb-5">
            <i class="fas fa-list mr-2"></i>Daftar Ruangan Tersedia
        </h3>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5 mb-8">

            {% for room in rooms_pagination.items %}
            <div class="room-card bg-white/80 backdrop-blur-md rounded-2xl shadow-md hover:shadow-xl p-5 transition-transform transform hover:-translate-y-1 border-t-4 border-blue-500">
                <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center mb-2">
                    <h3 class="text-lg font-bold text-blue-600 mb-2 sm:mb-0">
                        <i class="fas fa-door-open mr-2"></i>{{ room.name }}
                    </h3>
                    <a href="{{ url_for('tv_display', room_id=room.id) }}" class="py-2 px-3 bg-cyan-500 text-white text-xs font-semibold rounded-full hover:bg-cyan-600 transition-colors duration-300 shadow-md flex items-center justify-center w-full sm:w-auto">
                        <i class="fas fa-tv mr-2"></i>Jadwal
                    </a>
                </div>
                <p class="text-gray-700 text-sm"><strong>Lantai:</strong> {{ room.lantai or 'Tidak Ditentukan' }}</p>
            </div>
            {% endfor %}
        </div>


        {% if rooms_pagination.pages > 1 %}
        <nav class="flex justify-center mt-8">
            <ul class="flex items-center space-x-2 pagination">
                {% if rooms_pagination.has_prev %}
                <li>
                    <a href="{{ url_for('home', page=rooms_pagination.prev_num) }}" class="flex items-center justify-center h-10 w-10 text-gray-700 bg-gray-200 rounded-full hover:bg-gray-300 transition-colors duration-200">
                        <i class="fas fa-chevron-left"></i>
                    </a>
                </li>
                {% endif %}

                {% for page_num in rooms_pagination.iter_pages() %}
                <li>
                    {% if page_num %}
                        {% if rooms_pagination.page == page_num %}
                        <a href="#" class="flex items-center justify-center h-10 w-10 font-bold text-white bg-blue-700 rounded-full">{{ page_num }}</a>
                        {% else %}
                        <a href="{{ url_for('home', page=page_num) }}" class="flex items-center justify-center h-10 w-10 text-gray-700 bg-gray-200 rounded-full hover:bg-gray-300 transition-colors duration-200">{{ page_num }}</a>
                        {% endif %}
                    {% else %}
                        <span class="flex items-center justify-center h-10 w-10 text-gray-500">...</span>
                    {% endif %}
                </li>
                {% endfor %}

                {% if rooms_pagination.has_next %}
                <li>
                    <a href="{{ url_for('home', page=rooms_pagination.next_num) }}" class="flex items-center justify-center h-10 w-10 text-gray-700 bg-gray-200 rounded-full hover:bg-gray-300 transition-colors duration-200">
                        <i class="fas fa-chevron-right"></i>
                    </a>
                </li>
                {% endif %}
            </ul>
        </nav>
        {% endif %}

        
    </div>
</div>

<div id="logout-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[9999] hidden">
    <div id="logout-modal-content"
            class="bg-white/80 backdrop-blur-md rounded-3xl shadow-2xl p-6 max-w-xs sm:max-w-sm w-full mx-auto text-center transform transition-all duration-300 scale-95 opacity-0">
        <div class="flex flex-col items-center justify-center mb-5">
            <div class="w-14 h-14 bg-red-100 rounded-full flex items-center justify-center mb-3">
                <i class="fas fa-sign-out-alt text-red-500 text-2xl"></i>
            </div>
            <h3 class="text-xl font-bold text-gray-800 mb-2">Konfirmasi Logout</h3>
            <p class="text-gray-600 text-base">Apakah Anda yakin ingin keluar dari akun ini?</p>
        </div>
        <div class="flex flex-col sm:flex-row justify-center gap-3">
            <button id="cancel-logout"
                    class="bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded-full hover:bg-gray-300 transition-colors duration-300 w-full text-sm">
                Batal
            </button>
            <form method="POST" action="{{ url_for('logout') }}" class="w-full">
                <button type="submit"
                        class="bg-red-500 text-white font-semibold py-2 px-4 rounded-full hover:bg-red-600 transition-colors duration-300 w-full text-sm">
                    Ya, Logout
                </button>
            </form>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function () {

    const logoutButtonDesktop = document.getElementById('logout-button-desktop');
    const logoutButtonMobile = document.getElementById('logout-button-mobile');
    const logoutModal = document.getElementById('logout-modal');
    const modalContent = document.getElementById('logout-modal-content');
    const cancelLogout = document.getElementById('cancel-logout');

    function showLogoutModal(e) {
        e.preventDefault();
        logoutModal.classList.remove('hidden');
        setTimeout(() => {
            modalContent.classList.remove('scale-95', 'opacity-0');
            modalContent.classList.add('scale-100', 'opacity-100');
        }, 10);
    }


    if (logoutButtonDesktop) {
        logoutButtonDesktop.addEventListener('click', showLogoutModal);
    }
    if (logoutButtonMobile) {
        logoutButtonMobile.addEventListener('click', showLogoutModal);
    }

    function closeModal() {
        modalContent.classList.remove('scale-100', 'opacity-100');
        modalContent.classList.add('scale-95', 'opacity-0');
        setTimeout(() => {
            logoutModal.classList.add('hidden');
        }, 300);
    }

    cancelLogout.addEventListener('click', closeModal);
    logoutModal.addEventListener('click', function (e) {
        if (e.target === logoutModal) {
            closeModal();
        }
    });

    const configDropdownButton = document.getElementById('configDropdown');
    const configDropdownMenu = document.getElementById('configDropdownMenu');
    const configDropdownIcon = document.querySelector('.dropdown-icon');

    if (configDropdownButton && configDropdownMenu) {
        configDropdownButton.addEventListener('click', function (e) {
            e.stopPropagation();
            const isExpanded = this.getAttribute('aria-expanded') === 'true';

            if (isExpanded) {
                configDropdownMenu.classList.add('scale-95', 'opacity-0', 'invisible');
                configDropdownMenu.classList.remove('scale-100', 'opacity-100', 'visible');
                if (configDropdownIcon) configDropdownIcon.classList.remove('dropdown-icon-rotated');
                this.setAttribute('aria-expanded', 'false');
            } else {
                configDropdownMenu.classList.remove('scale-95', 'opacity-0', 'invisible');
                configDropdownMenu.classList.add('scale-100', 'opacity-100', 'visible');
                if (configDropdownIcon) configDropdownIcon.classList.add('dropdown-icon-rotated');
                this.setAttribute('aria-expanded', 'true');
            }
        });

        document.addEventListener('click', function (e) {
            if (!configDropdownMenu.contains(e.target) && !configDropdownButton.contains(e.target)) {
                configDropdownMenu.classList.add('scale-95', 'opacity-0', 'invisible');
                configDropdownMenu.classList.remove('scale-100', 'opacity-100', 'visible');
                if (configDropdownIcon) configDropdownIcon.classList.remove('dropdown-icon-rotated');
                configDropdownButton.setAttribute('aria-expanded', 'false');
            }
        });
    }
});
</script>

</body>
</html>
